#:kivy 1.0

<Label>
    color: (0, 0, 0, 1)

<Arrow>
    head_angle: 60
    main_color: (0, 0, 0, 1)
    outline_color: (1, 1, 1, 0)
    fletching_radius: 0
    arrow_at_midpoint: True

<Battery@Widget>
    canvas:
        Color:
            rgba: app.battery_color
        Rectangle:
            pos: (self.x, self.y)
            size: (self.width, self.height * 0.95 * app.battery_level/100)
        Color:
            rgba: 0, 0, 0, 1
        Line:
            width: 4.
            rectangle: (self.x, self.y, self.width, self.height * .95)
        Line:
            width: 4.
            rectangle: (self.x+self.width*0.4, self.y+self.height*.95, self.width*0.2, self.height * .05)


<CurrentStatus@FloatLayout>:
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
#    cols: 2
    Label:
        text: 'Dene Road Energy Hub'
        pos_hint: {'centre_x': 0.0, 'y': 0.45}
    IconButton:
        source: 'energyhub/resources/icons8-reset-48.png'
        text: 'Refresh'
        on_press: app.refresh()
        pos_hint: {'x': 0.9, 'y': 0.9}
        size_hint: (0.1, 0.1)
    Image:
        source: 'energyhub/resources/Solar_panel_icon.png'
        size_hint: (0.1, 0.1)
        allow_stretch: False
        pos_hint: {'x': 0.5 - ((self.width/self.parent.width) / 2), 'y': 0.8}
    Arrow:
        o_x: self.parent.width * 0.5
        o_y: self.parent.height * 0.8
        distance: self.parent.height * 0.1
        angle: 270
    Label:
        text: f'{app.solar_production} kW'
        pos_hint: {'y': 0.72, 'x': 0.52}
        size_hint: (0.1, 0.1)
    Arrow:
        o_x: self.parent.width * 0.3
        o_y: self.parent.height * 0.7
        distance: self.parent.width * 0.2
        angle: 0
        head_size: 10 + (30 * app.battery_production / 5)
        reverse_arrow: app.battery_state == 'Charging'
    Label:
        text: f'{app.battery_production} kW'
        pos_hint: {'y': 0.7, 'x': 0.35}
        size_hint: (0.1, 0.1)
    Battery:
        size_hint: (0.034, 0.1)
        pos_hint: {'x': 0.25 - ((self.width/self.parent.width) / 2), 'y': 0.65}
    Label:
        text: f'{app.battery_level} %'
        pos_hint: {'y': 0.65, 'x': 0.15}
        size_hint: (0.05, 0.1)
#    Arrow:
#        o_x: self.parent.width * 0.7
#        o_y: self.parent.height * 0.7
#        distance: self.parent.width * 0.2
#        angle: 180
#    Label:
#        text: f'{app.grid_power} kW'
#        pos_hint: {'y': 0.7, 'x': 0.65}
#        size_hint: (0.1, 0.1)

    Label:
        text: 'Car Battery Level'
    Label:
        text: f'{app.car_battery_level} %'
    Label:
        text: 'Zappi Current Power'
    Label:
        text: f'{app.zappi_power} kW'
    Label:
        text: 'Eddi Current Power'
    Label:
        text: f'{app.eddi_power} kW'

CurrentStatus